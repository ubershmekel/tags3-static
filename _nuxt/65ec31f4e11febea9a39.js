(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{188:function(e,t,r){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}r.d(t,"a",function(){return o})},189:function(e,t,r){"use strict";r.d(t,"c",function(){return l}),r.d(t,"g",function(){return d}),r.d(t,"e",function(){return m}),r.d(t,"f",function(){return f}),r.d(t,"h",function(){return v}),r.d(t,"d",function(){return h}),r.d(t,"b",function(){return y}),r.d(t,"a",function(){return w});var n=r(40),o=r(188),c=(r(114),r(115),r(6));r(76);function l(e){return e>=1e9?(e/1e9).toFixed(1).replace(/\.0$/,"")+"G":e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K":e}function d(e){"object"!==Object(c.a)(e)&&(e=new Date(e));var t,r=Math.floor((+new Date-+e)/1e3),n=Math.floor(r/31536e3);return n>=1?t="year":(n=Math.floor(r/2592e3))>=1?t="month":(n=Math.floor(r/86400))>=1?t="day":(n=Math.floor(r/3600))>=1?t="hour":(n=Math.floor(r/60))>=1?t="minute":(n=r,t="second"),(n>1||0===n)&&(t+="s"),n+" "+t}function m(e,t,r){return e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),r)}function f(e){return Math.round(100*e)/100}function v(e){return"https://www.youtube.com/embed/"+h(e)+"?autoplay=1"}function h(e){var t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);return t&&11===t[2].length?t[2]:"error"}var y=function(){function e(t){var r=t.endCallback,o=t.durationMs;Object(n.a)(this,e),this.start=new Date,this.durationMs=o,this.endCallback=r,this.timerId=window.setTimeout(r,o)}return Object(o.a)(e,[{key:"isActive",value:function(){return!!(this.timerId&&this.percentProgress()<100)}},{key:"cancel",value:function(){if(null===this.timerId)throw new Error("Double cancel of timer");window.clearTimeout(this.timerId),this.timerId=null}},{key:"percentProgress",value:function(){var e=(Date.now()-this.start.getTime())/this.durationMs*100;return e>100?100:e}}]),e}(),w=function(){function e(t){var r=t.durationMs,o=t.progressCallback;Object(n.a)(this,e),this.start=new Date,this.durationMs=r,this.progressCallback=o,this.intervalId=window.setInterval(o,r)}return Object(o.a)(e,[{key:"cancel",value:function(){if(null===this.intervalId)throw new Error("Double cancel of timer");window.clearInterval(this.intervalId),this.intervalId=null}}]),e}()},190:function(e,t,r){"use strict";r.d(t,"a",function(){return h}),r.d(t,"c",function(){return w}),r.d(t,"b",function(){return _});r(61);var n=r(7),o=r(77),c=r.n(o),l="https://us-east1-ubershmekel.cloudfunctions.net/tags3-api";var d=l+"?q=",m=l+"?notifyquery=1",f=l+"?unsubscribe=",v={validateStatus:function(e){return!0}};function h(e){return y.apply(this,arguments)}function y(){return(y=Object(n.a)(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={results:null,error:null},performance.now(),e.prev=2,e.next=5,c.a.get(d+encodeURI(t),v);case 5:n=e.sent,console.log("query res",n),n.data.error?r.error=n.data.error:r.results=n.data,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("Failed to fetch query",e.t0),e.t0&&e.t0.message?r.error=e.t0.message:r.error=""+e.t0;case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}},e,null,[[2,10]])}))).apply(this,arguments)}function w(e){return O.apply(this,arguments)}function O(){return(O=Object(n.a)(regeneratorRuntime.mark(function e(data){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={error:"Failed to send subscribe request",success:""},e.prev=1,e.next=4,c.a.post(m,data,v);case 4:r=e.sent,console.log("subscribe res",r),t=r.data,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Failed to fetch query",e.t0),e.t0&&e.t0.message?t.error=e.t0.message:t.error=""+e.t0;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}},e,null,[[1,9]])}))).apply(this,arguments)}function _(e){return j.apply(this,arguments)}function j(){return(j=Object(n.a)(regeneratorRuntime.mark(function e(t){var r,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={error:"Failed to send unsubscribe request",success:""},e.prev=1,n=f+t,e.next=5,c.a.get(n,v);case 5:o=e.sent,console.log("unsubscribe res",o),r=o.data,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("Failed to fetch query",e.t0),e.t0&&e.t0.message?r.error=e.t0.message:r.error=""+e.t0;case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}},e,null,[[1,10]])}))).apply(this,arguments)}},193:function(e,t,r){"use strict";var n=r(40),o=r(188),c=r(42),l=r(41),d=r(43),m=r(6),f=r(17),v=r(189),h=function(e,t,r,desc){var n,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,r):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(m.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,desc);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(c=(o<3?n(c):o>3?n(t,r,c):n(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c},y=function(e){function t(){return Object(n.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"channelQueryLink",value:function(e){return'/q?q=SELECT * FROM url WHERE "channel" = \''.concat(e,"' ORDER BY likes DESC LIMIT 50")}},{key:"userQueryLink",value:function(e){return'/q?q=SELECT * FROM url WHERE "user" = \''.concat(e,"' ORDER BY likes DESC LIMIT 50")}},{key:"domainQueryLink",value:function(e){return'/q?q=SELECT * FROM url WHERE "domain" = \''.concat(e,"' ORDER BY likes DESC LIMIT 50")}}]),t}(f.Vue);h([Object(f.Prop)(Object)],y.prototype,"item",void 0);var w=y=h([Object(f.Component)({methods:{compactNumber:v.c,timeSince:v.g},components:{}})],y),O=(r(222),r(11)),component=Object(O.a)(w,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"item-info"},[r("a",{staticClass:"item-title",attrs:{href:e.item.url}},[e._v(e._s(e.item.title))]),e._v(" "),r("div",{staticClass:"item-meta"},[e.item.likes?r("span",{staticClass:"like-count"},[e._v(e._s(e.compactNumber(e.item.likes))+"‚¨Ü")]):e._e(),e._v(" "),e.item.views?r("span",{staticClass:"view-count"},[e._v(e._s(e.compactNumber(e.item.views))+"üëÅ")]):e._e(),e._v(" "),r("span",{staticClass:"domain",attrs:{title:e.item.timestamp}},[e._v("\n      / "),r("nuxt-link",{attrs:{to:e.domainQueryLink(e.item.domain)}},[e._v(e._s(e.item.domain))]),e._v(" "),e.item.channel&&e.item.channel!==e.item.user?[e._v("\n        / "),r("nuxt-link",{attrs:{to:e.channelQueryLink(e.item.channel)}},[e._v(e._s(e.item.channel))])]:e._e(),e._v("\n      / "),r("nuxt-link",{attrs:{to:e.userQueryLink(e.item.user)}},[e._v(e._s(e.item.user))]),e._v("\n      / "+e._s(e.timeSince(e.item.timestamp))+" ago\n      / "),r("nuxt-link",{attrs:{to:"/url?url="+e.item.url}},[e._v("t")])],2)])])},[],!1,null,"036d8e7c",null);t.a=component.exports},195:function(e,t,r){var content=r(221);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(24).default)("16dced34",content,!0,{sourceMap:!1})},196:function(e,t,r){var content=r(223);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(24).default)("5c93dcd0",content,!0,{sourceMap:!1})},216:function(e,t,r){"use strict";var n=r(40),o=r(42),c=r(41),l=r(43),d=r(6),m=r(17),f=r(217),v=r(189),h=function(e,t,r,desc){var n,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,r):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(d.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,desc);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(c=(o<3?n(c):o>3?n(t,r,c):n(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c},y=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(o.a)(this,Object(c.a)(t).apply(this,arguments))).youtubePlay=!1,e}return Object(l.a)(t,e),t}(m.Vue);h([Object(m.Prop)(Object)],y.prototype,"item",void 0);var w=y=h([Object(m.Component)({methods:{youtubeEmbedUrl:v.h},components:{Video:f.a}})],y),O=(r(220),r(11)),component=Object(O.a)(w,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"item-view-container"},[e.item.video_url?r("Video",{key:e.item.video_url,staticClass:"item-main item-video",attrs:{"auto-play":!1,"video-url":e.item.video_url,"audio-url":e.item.audio_url,poster:e.item.image_url}}):e._e(),e._v(" "),e.item.image_url&&!e.item.video_url?r("img",{staticClass:"item-main item-image",attrs:{src:e.item.image_url,onerror:"this.style.display='none'"}}):e._e(),e._v(" "),e.youtubePlay?e._e():r("div",{staticClass:"maybe-play-button-container",on:{click:function(t){e.youtubePlay=!0}}},[!e.item.thumbnail_url||e.item.image_url||e.item.video_url?e._e():r("img",{staticClass:"item-main item-image",attrs:{src:e.item.thumbnail_url,onerror:"this.style.display='none'"}}),e._v(" "),"youtube.com"===e.item.domain?r("svg",{staticClass:"play-button",attrs:{viewBox:"0 0 200 200"}},[r("polygon",{staticStyle:{fill:"white","stroke-width":"0"},attrs:{points:"0,0 200,100 0,200"}})]):e._e()]),e._v(" "),"youtube.com"===e.item.domain?r("div",{staticClass:"youtube-embed item-main"},[e.youtubePlay?r("div",[r("iframe",{attrs:{width:"100%",height:"315",src:e.youtubeEmbedUrl(e.item.url),frameborder:"0",autoplay:"1",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}})]):e._e()]):e._e()],1)},[],!1,null,"7eecfe0e",null);t.a=component.exports},217:function(e,t,r){"use strict";var n=r(40),o=r(188),c=r(42),l=r(41),d=r(43),m=r(6),f=r(17),v=function(e,t,r,desc){var n,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,r):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(m.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,desc);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(c=(o<3?n(c):o>3?n(t,r,c):n(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c},h=function(e){function t(){return Object(n.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"onMuteChange",value:function(e,t){this.$el.muted=e}},{key:"progress",value:function(){var e=this.$el;return e&&e.duration>0?100*e.currentTime/e.duration:0}},{key:"scrollEvent",value:function(e){var t=this.$el;(function(e){var rect=e.getBoundingClientRect(),t=rect.top,r=rect.bottom;return t<window.innerHeight&&r>=0})(t)||t.paused||t.pause()}},{key:"created",value:function(){window.addEventListener("scroll",this.scrollEvent)}},{key:"destroyed",value:function(){window.removeEventListener("scroll",this.scrollEvent)}},{key:"mounted",value:function(){var e=this,t=this.$el;t.muted=this.mute,this.autoPlay&&(t.autoplay=!0);var r=!1;t.addEventListener("timeupdate",function(n){t.currentTime<.1&&!r&&(r=!0,e.onEnded?e.onEnded(n):console.log("Video ended but no on-ended handler"),1,setTimeout(function(){r=!1},500))},!0)}}]),t}(f.Vue);v([Object(f.Prop)(Boolean)],h.prototype,"mute",void 0),v([Object(f.Prop)(String)],h.prototype,"videoUrl",void 0),v([Object(f.Prop)(String)],h.prototype,"audioUrl",void 0),v([Object(f.Prop)(String)],h.prototype,"poster",void 0),v([Object(f.Prop)(Boolean)],h.prototype,"autoPlay",void 0),v([Object(f.Prop)(Function)],h.prototype,"onEnded",void 0),v([Object(f.Watch)("mute")],h.prototype,"onMuteChange",null);var y=h=v([Object(f.Component)({methods:{}})],h),w=r(11),component=Object(w.a)(y,function(){var e=this.$createElement,t=this._self._c||e;return t("video",{attrs:{playsinline:"",loop:"",controls:"",poster:this.poster}},[t("source",{attrs:{src:this.videoUrl}}),this._v(" "),this.audioUrl?t("source",{attrs:{src:this.audioUrl,type:"audio/aac"}}):this._e()])},[],!1,null,"5854d559",null);t.a=component.exports},220:function(e,t,r){"use strict";var n=r(195);r.n(n).a},221:function(e,t,r){(e.exports=r(23)(!1)).push([e.i,".item-main[data-v-7eecfe0e]{max-width:100%;max-height:80vh}item-image[data-v-7eecfe0e]{min-height:40px}.item-view-container[data-v-7eecfe0e]{text-align:center;display:block;background-color:#222;max-width:100%;max-height:80vh}.play-button[data-v-7eecfe0e]{height:50%;display:block;position:absolute;left:0;right:0;bottom:0;top:0;margin:auto;opacity:.6;pointer-events:none}.maybe-play-button-container[data-v-7eecfe0e]{position:relative}",""])},222:function(e,t,r){"use strict";var n=r(196);r.n(n).a},223:function(e,t,r){(e.exports=r(23)(!1)).push([e.i,".item[data-v-036d8e7c]{border-radius:4px;padding:4px;background-color:#333;margin:1em;border-left:1px solid #ddd}.domain[data-v-036d8e7c]{opacity:.6}.domain a[data-v-036d8e7c]{font-weight:400}.item-title[data-v-036d8e7c]{display:block}.item-meta[data-v-036d8e7c]{color:#999}.item-info[data-v-036d8e7c]{vertical-align:top;margin-left:.5em}.stats[data-v-036d8e7c]{opacity:.6}",""])}}]);